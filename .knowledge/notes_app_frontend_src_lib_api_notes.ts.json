{"is_source_file": true, "format": "TypeScript", "description": "This file defines the API layer for managing notes, including CRUD operations and toggling favorites. It supports both real API calls and in-memory fallback for environments without a backend, with functions for listing, retrieving, creating, updating, deleting, and toggling notes. The file also manages internal types and local storage of notes when API is not configured.", "external_files": ["../config", "../api/client", "../types"], "external_methods": ["fetchJson"], "published": ["listNotes", "getNote", "createNote", "updateNote", "deleteNote", "toggleFavorite", "NoteInput", "NotesQuery", "Note"], "classes": [], "methods": [{"name": "export async function listNotes(query?: NotesQuery, signal?: AbortSignal): Promise<Note[]> { listNotes", "description": "Fetches a list of notes, either from API or in-memory fallback, applying optional filters and pagination.", "scope": "", "scopeKind": ""}, {"name": "export async function getNote(id: string, signal?: AbortSignal): Promise<Note> { getNote", "description": "Retrieves a specific note by its ID, from API or fallback.", "scope": "", "scopeKind": ""}, {"name": "export async function createNote(input: NoteInput): Promise<Note> { createNote", "description": "Creates a new note with provided input, adding it to in-memory store or sending to backend.", "scope": "", "scopeKind": ""}, {"name": "export async function updateNote(id: string, input: NoteInput): Promise<Note> { updateNote", "description": "Updates an existing note identified by ID with new data.", "scope": "", "scopeKind": ""}, {"name": "export async function deleteNote(id: string): Promise<{ id: string }> { deleteNote", "description": "Deletes a note by its ID.", "scope": "", "scopeKind": ""}, {"name": "export async function toggleFavorite(id: string): Promise<Note> { toggleFavorite", "description": "Toggles the favorite status of a note.", "scope": "", "scopeKind": ""}, {"name": "function isMemoryMode(): boolean { isMemoryMode", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function matchQuery(n: InternalNote, q?: NotesQuery): boolean { matchQuery", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function paginate<T>(arr: T[], page?: number, pageSize?: number): T[] { paginate", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function randomId(): string { randomId", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function toPublic(n: InternalNote): Note { toPublic", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["fetchJson", "matchQuery", "toPublic"], "search-terms": ["Notes API", "fallback in-memory store", "CRUD operations", "toggleFavorite", "NotesQuery", "internal note handling"], "state": 2, "file_id": 21, "knowledge_revision": 89, "git_revision": "", "revision_history": [{"56": ""}, {"63": ""}, {"64": ""}, {"66": ""}, {"70": ""}, {"71": ""}, {"72": ""}, {"81": ""}, {"82": ""}, {"89": ""}], "ctags": [{"_type": "tag", "name": "$", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const url = `${API_BASE_URL}\\/notes${params.toString() ? `?${params}` : \"\"}`;$/", "language": "TypeScript", "kind": "constant", "scope": "listNotes", "scopeKind": "function"}, {"_type": "tag", "name": "InternalNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^type InternalNote = Note & { _createdAt: number; _updatedAt: number };$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "NoteInput", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^export type NoteInput = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "NotesQuery", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^export type NotesQuery = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "_createdAt", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    _createdAt: Date.now() - 1000 * 60 * 60 * 24,$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "_createdAt", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const { _createdAt, _updatedAt, ...pub } = n;$/", "language": "TypeScript", "kind": "constant", "scope": "toPublic", "scopeKind": "function"}, {"_type": "tag", "name": "_updatedAt", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    _updatedAt: Date.now(),$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "_updatedAt", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const { _createdAt, _updatedAt, ...pub } = n;$/", "language": "TypeScript", "kind": "constant", "scope": "toPublic", "scopeKind": "function"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    content: input.content ?? memoryNotes[idx].content,$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "createNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^export async function createNote(input: NoteInput): Promise<Note> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "deleteNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^export async function deleteNote(id: string): Promise<{ id: string }> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "favorite", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    favorite: !memoryNotes[idx].favorite,$/", "language": "TypeScript", "kind": "constant", "scope": "toggleFavorite", "scopeKind": "function"}, {"_type": "tag", "name": "favorite", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    favorite:$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "filtered", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const filtered = memoryNotes$/", "language": "TypeScript", "kind": "constant", "scope": "listNotes", "scopeKind": "function"}, {"_type": "tag", "name": "found", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const found = memoryNotes.find((n) => n.id === id);$/", "language": "TypeScript", "kind": "constant", "scope": "getNote", "scopeKind": "function"}, {"_type": "tag", "name": "getNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^export async function getNote(id: string, signal?: AbortSignal): Promise<Note> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "hay", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const hay = `${n.title} ${n.content}`.toLowerCase();$/", "language": "TypeScript", "kind": "constant", "scope": "matchQuery", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^        : memoryNotes[idx].favorite,$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    ...memoryNotes[idx],$/", "language": "TypeScript", "kind": "constant", "scope": "toggleFavorite", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    ...memoryNotes[idx],$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    content: input.content ?? memoryNotes[idx].content,$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    title: input.title ?? memoryNotes[idx].title,$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const idx = memoryNotes.findIndex((n) => n.id === id);$/", "language": "TypeScript", "kind": "constant", "scope": "deleteNote", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const idx = memoryNotes.findIndex((n) => n.id === id);$/", "language": "TypeScript", "kind": "constant", "scope": "toggleFavorite", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const idx = memoryNotes.findIndex((n) => n.id === id);$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "isMemoryMode", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^function isMemoryMode(): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "listNotes", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^export async function listNotes(query?: NotesQuery, signal?: AbortSignal): Promise<Note[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "matchQuery", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^function matchQuery(n: InternalNote, q?: NotesQuery): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "memoryNotes", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    content: input.content ?? memoryNotes[idx].content,$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "memoryNotes", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    title: input.title ?? memoryNotes[idx].title,$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "memoryNotes", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^const memoryNotes: InternalNote[] = [$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "newNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const newNote: InternalNote = {$/", "language": "TypeScript", "kind": "constant", "scope": "createNote", "scopeKind": "function"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const now = Date.now();$/", "language": "TypeScript", "kind": "constant", "scope": "createNote", "scopeKind": "function"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const p = Math.max(1, page || 1);$/", "language": "TypeScript", "kind": "constant", "scope": "paginate", "scopeKind": "function"}, {"_type": "tag", "name": "page", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const page = paginate(filtered, query?.page, query?.pageSize);$/", "language": "TypeScript", "kind": "constant", "scope": "listNotes", "scopeKind": "function"}, {"_type": "tag", "name": "paginate", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^function paginate<T>(arr: T[], page?: number, pageSize?: number): T[] {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "params", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const params = new URLSearchParams();$/", "language": "TypeScript", "kind": "constant", "scope": "listNotes", "scopeKind": "function"}, {"_type": "tag", "name": "params", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const url = `${API_BASE_URL}\\/notes${params.toString() ? `?${params}` : \"\"}`;$/", "language": "TypeScript", "kind": "constant", "scope": "listNotes", "scopeKind": "function"}, {"_type": "tag", "name": "ps", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const ps = Math.max(1, pageSize || 20);$/", "language": "TypeScript", "kind": "constant", "scope": "paginate", "scopeKind": "function"}, {"_type": "tag", "name": "randomId", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^function randomId(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "search", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const search = (q.search || \"\").toLowerCase().trim();$/", "language": "TypeScript", "kind": "constant", "scope": "matchQuery", "scopeKind": "function"}, {"_type": "tag", "name": "start", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const start = (p - 1) * ps;$/", "language": "TypeScript", "kind": "constant", "scope": "paginate", "scopeKind": "function"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    title: input.title ?? memoryNotes[idx].title,$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "toPublic", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^function toPublic(n: InternalNote): Note {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "toggleFavorite", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^export async function toggleFavorite(id: string): Promise<Note> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "updateNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^export async function updateNote(id: string, input: NoteInput): Promise<Note> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const updated: InternalNote = {$/", "language": "TypeScript", "kind": "constant", "scope": "toggleFavorite", "scopeKind": "function"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^  const updated: InternalNote = {$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const url = `${API_BASE_URL}\\/notes${params.toString() ? `?${params}` : \"\"}`;$/", "language": "TypeScript", "kind": "constant", "scope": "listNotes", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const url = `${API_BASE_URL}\\/notes\\/${encodeURIComponent(id)}\\/favorite`;$/", "language": "TypeScript", "kind": "constant", "scope": "toggleFavorite", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const url = `${API_BASE_URL}\\/notes\\/${encodeURIComponent(id)}`;$/", "language": "TypeScript", "kind": "constant", "scope": "deleteNote", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const url = `${API_BASE_URL}\\/notes\\/${encodeURIComponent(id)}`;$/", "language": "TypeScript", "kind": "constant", "scope": "getNote", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const url = `${API_BASE_URL}\\/notes\\/${encodeURIComponent(id)}`;$/", "language": "TypeScript", "kind": "constant", "scope": "updateNote", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-197440-197449/notes_app_frontend/src/lib/api/notes.ts", "pattern": "/^    const url = `${API_BASE_URL}\\/notes`;$/", "language": "TypeScript", "kind": "constant", "scope": "createNote", "scopeKind": "function"}], "hash": "631439af26126f58ae0b29224cca8da3", "format-version": 4, "code-base-name": "notes_app_frontend", "filename": "notes_app_frontend/src/lib/api/notes.ts"}